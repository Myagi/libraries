{"version":3,"file":"fraql.js","sources":["../node_modules/xtend/immutable.js","../src/transform.js","../src/fraql.js"],"sourcesContent":["module.exports = extend\n\nvar hasOwnProperty = Object.prototype.hasOwnProperty;\n\nfunction extend() {\n    var target = {}\n\n    for (var i = 0; i < arguments.length; i++) {\n        var source = arguments[i]\n\n        for (var key in source) {\n            if (hasOwnProperty.call(source, key)) {\n                target[key] = source[key]\n            }\n        }\n    }\n\n    return target\n}\n","import { print, Source } from 'graphql/language'\nimport extend from 'xtend'\n\nfunction inlineSpreadFragments(fragmentDefinitions, definition) {\n  if (definition.kind === 'FragmentSpread') {\n    return fragmentDefinitions.find(\n      ({ name }) => name.value === definition.name.value,\n    )\n  }\n  if (!definition.selectionSet) {\n    return definition\n  }\n\n  definition.selectionSet = extend(definition.selectionSet, {\n    selections: definition.selectionSet.selections.map(selection =>\n      inlineSpreadFragments(fragmentDefinitions, selection),\n    ),\n  })\n\n  return definition\n}\n\nexport function toInlineFragment(doc) {\n  let definitions = doc.definitions.map(definition => {\n    if (definition.kind !== 'FragmentDefinition') {\n      throw new Error(\n        `fraql: toInlineFragment must be called on a document that only contains fragments`,\n      )\n    }\n\n    return {\n      kind: 'InlineFragment',\n      name: definition.name,\n      directives: definition.directives,\n      selectionSet: definition.selectionSet,\n      typeCondition: definition.typeCondition,\n    }\n  })\n\n  definitions = definitions.map(definition =>\n    inlineSpreadFragments(definitions, definition),\n  )\n\n  const definition = definitions[0]\n\n  if (!definition) {\n    throw new Error('Unable to find a fragment definition')\n  }\n\n  const newDoc = extend(doc, {\n    originalDocument: doc,\n    definitions: [definition],\n  })\n\n  newDoc.loc = extend(doc.loc, {\n    source: new Source(print(newDoc)),\n  })\n\n  return newDoc\n}\n","import gql, { disableFragmentWarnings } from 'graphql-tag'\nimport { toInlineFragment } from './transform'\n\nconst fraql = (...args) => {\n  disableFragmentWarnings()\n\n  const doc = gql(...args)\n\n  if (doc.definitions.every(({ kind }) => kind === 'FragmentDefinition')) {\n    return toInlineFragment(doc)\n  }\n\n  return doc\n}\n\nexport default fraql\n"],"names":["module","extend","hasOwnProperty","Object","prototype","target","i","arguments","length","source","key","call","inlineSpreadFragments","fragmentDefinitions","definition","kind","find","name","value","selectionSet","selections","map","selection","toInlineFragment","doc","definitions","Error","directives","typeCondition","newDoc","originalDocument","loc","Source","print","fraql","disableFragmentWarnings","gql","every"],"mappings":";;;;;;;;IAAAA,aAAA,GAAiBC,MAAjB;;IAEA,IAAIC,iBAAiBC,OAAOC,SAAP,CAAiBF,cAAtC;;IAEA,SAASD,MAAT,GAAkB;YACVI,SAAS,EAAb;;aAEK,IAAIC,IAAI,CAAb,EAAgBA,IAAIC,UAAUC,MAA9B,EAAsCF,GAAtC,EAA2C;gBACnCG,SAASF,UAAUD,CAAV,CAAb;;iBAEK,IAAII,GAAT,IAAgBD,MAAhB,EAAwB;oBAChBP,eAAeS,IAAf,CAAoBF,MAApB,EAA4BC,GAA5B,CAAJ,EAAsC;2BAC3BA,GAAP,IAAcD,OAAOC,GAAP,CAAd;;;;;eAKLL,MAAP;;;ICdJ,SAASO,qBAAT,CAA+BC,mBAA/B,EAAoDC,UAApD,EAAgE;IAC9D,MAAIA,WAAWC,IAAX,KAAoB,gBAAxB,EAA0C;IACxC,WAAOF,oBAAoBG,IAApB,CACL;IAAA,UAAGC,IAAH,QAAGA,IAAH;IAAA,aAAcA,KAAKC,KAAL,KAAeJ,WAAWG,IAAX,CAAgBC,KAA7C;IAAA,KADK,CAAP;IAGD;IACD,MAAI,CAACJ,WAAWK,YAAhB,EAA8B;IAC5B,WAAOL,UAAP;IACD;;IAEDA,aAAWK,YAAX,GAA0BlB,UAAOa,WAAWK,YAAlB,EAAgC;IACxDC,gBAAYN,WAAWK,YAAX,CAAwBC,UAAxB,CAAmCC,GAAnC,CAAuC;IAAA,aACjDT,sBAAsBC,mBAAtB,EAA2CS,SAA3C,CADiD;IAAA,KAAvC;IAD4C,GAAhC,CAA1B;;IAMA,SAAOR,UAAP;IACD;;AAED,IAAO,SAASS,gBAAT,CAA0BC,GAA1B,EAA+B;IACpC,MAAIC,cAAcD,IAAIC,WAAJ,CAAgBJ,GAAhB,CAAoB,sBAAc;IAClD,QAAIP,WAAWC,IAAX,KAAoB,oBAAxB,EAA8C;IAC5C,YAAM,IAAIW,KAAJ,qFAAN;IAGD;;IAED,WAAO;IACLX,YAAM,gBADD;IAELE,YAAMH,WAAWG,IAFZ;IAGLU,kBAAYb,WAAWa,UAHlB;IAILR,oBAAcL,WAAWK,YAJpB;IAKLS,qBAAed,WAAWc;IALrB,KAAP;IAOD,GAdiB,CAAlB;;IAgBAH,gBAAcA,YAAYJ,GAAZ,CAAgB;IAAA,WAC5BT,sBAAsBa,WAAtB,EAAmCX,UAAnC,CAD4B;IAAA,GAAhB,CAAd;;IAIA,MAAMA,aAAaW,YAAY,CAAZ,CAAnB;;IAEA,MAAI,CAACX,UAAL,EAAiB;IACf,UAAM,IAAIY,KAAJ,CAAU,sCAAV,CAAN;IACD;;IAED,MAAMG,SAAS5B,UAAOuB,GAAP,EAAY;IACzBM,sBAAkBN,GADO;IAEzBC,iBAAa,CAACX,UAAD;IAFY,GAAZ,CAAf;;IAKAe,SAAOE,GAAP,GAAa9B,UAAOuB,IAAIO,GAAX,EAAgB;IAC3BtB,YAAQ,IAAIuB,eAAJ,CAAWC,eAAMJ,MAAN,CAAX;IADmB,GAAhB,CAAb;;IAIA,SAAOA,MAAP;IACD;;ICxDD,IAAMK,QAAQ,SAARA,KAAQ,GAAa;IACzBC;;IAEA,MAAMX,MAAMY,wCAAZ;;IAEA,MAAIZ,IAAIC,WAAJ,CAAgBY,KAAhB,CAAsB;IAAA,QAAGtB,IAAH,QAAGA,IAAH;IAAA,WAAcA,SAAS,oBAAvB;IAAA,GAAtB,CAAJ,EAAwE;IACtE,WAAOQ,iBAAiBC,GAAjB,CAAP;IACD;;IAED,SAAOA,GAAP;IACD,CAVD;;;;;;;;;;;;;"}